<html lang="en">

<head>
  <meta charset="utf-8" />
  <meta content="width=device-width, initial-scale=1.0" name="viewport" />
  <title>Admin Dashboard</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css" rel="stylesheet" />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&amp;display=swap" rel="stylesheet" />
  <style>
    body {
      /* background-image: url('/static/firefly1.jpg'); */
      background-size: cover;
      background-repeat: no-repeat;
      background-position: center;
      font-family: 'Roboto', sans-serif;
      /* overflow-y: hidden;
     overflow-x: hidden;*/
    }

    .btn-animate {
      transition: transform 0.2s;
    }

    .btn-animate:hover {
      transform: scale(1.05);
    }

    .img-hover:hover {
      transform: scale(1.05);
      transition: transform 0.2s;
      cursor: pointer;
    }

    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.7);
      z-index: 1000;
    }

    .modal-content {
      display: flex;
      margin: 5% auto;
      width: 90%;
      height: 80%;
      background-color: #047857;
      border-radius: 10px;
      overflow: auto;
    }

    .blur-bg {
      filter: blur(5px);
    }

    .page {
      display: none;
      padding: 20px;
      height: 100%;
      width: 100%;
    }

    #mainDashboard {
      display: block;
    }

    .floating-card {
      box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
      transition: transform 0.3s ease-in-out;
      border-radius: 64px;
    }

    .floating-card:hover {
      transform: translateY(-7px);
      box-shadow: 0 7px 14px -3px rgba(0, 0, 0, 0.2), 0 4px 6px -2px rgba(0, 0, 0, 0.1);
    }

    .truncate {
      overflow: hidden;
      text-overflow: ellipsis;
      white-space: nowrap;
    }

    .sidebar {
      padding-top: 0px;
      height: 48vh;
      /* Set the height to half of the viewport height */
    }
  </style>
</head>

<body class="bg-[#016426] text-[#D3D3D3] p-4 rounded-lg">
  <!-- <body> -->
  <!-- Modal for graph expansion -->
  <div class="modal" id="graphModal">
    <div class="modal-content">
      <div class="flex w-full h-full">
        <div class="w-1/2 p-4 flex items-center justify-center">
          <img id="expandedGraph" src="" alt="Expanded graph" class="max-h-full max-w-full rounded-lg">
        </div>
        <div class="w-1/2 p-4 bg-green-700 rounded-lg m-4">
          <h2 id="graphTitle" class="text-2xl font-bold mb-4">Graph Information</h2>
          <div id="graphInfo" class="text-lg"></div>
          <button onclick="closeModal()"
            class="mt-8 bg-white text-green-700 px-4 py-2 rounded-lg btn-animate">Close</button>
        </div>
      </div>
    </div>
  </div>

  <!-- Pages Container -->
  <div id="pagesContainer">
    <!-- Main Dashboard Page -->
    <div id="mainDashboard" class="page">
      <div class="flex flex-col md:flex-row">
        <!-- Sidebar -->
        <div class="bg-green-700 w-full md:w-20 flex md:flex-col items-center py-4 space-y-4 floating-card sidebar">
          <button class="bg-white rounded-full p-3 btn-animate flex items-center justify-center w-12 h-12 
                         shadow-lg transform transition-all hover:scale-110 active:scale-95 hover:shadow-2xl"
            onclick="window.location.href='/'" title="Dashboard Home">
            <i class="fas fa-home text-gray-700"></i>
          </button>

          <button class="bg-white rounded-full p-3 btn-animate flex items-center justify-center w-12 h-12 
                         shadow-lg transform transition-all hover:scale-110 active:scale-95 hover:shadow-2xl"
            onclick="window.location.href='/predict'" title="Energy Predictions">
            <i class="fas fa-magic text-gray-700"></i>
          </button>

          <button class="bg-white rounded-full p-3 btn-animate flex items-center justify-center w-12 h-12 
                         shadow-lg transform transition-all hover:scale-110 active:scale-95 hover:shadow-2xl"
            onclick="window.location.href='/visualize'" title="Data Analytics">
            <i class="fas fa-chart-bar text-gray-700"></i>
          </button>

          <button class="bg-white rounded-full p-3 btn-animate flex items-center justify-center w-12 h-12 
                         shadow-lg transform transition-all hover:scale-110 active:scale-95 hover:shadow-2xl"
            onclick="window.location.href='/suggestions'" title="AI Suggestions">
            <i class="fas fa-lightbulb text-gray-700"></i>
          </button>
        </div>

        <!-- Main Content -->
        <div class="flex-1 p-4">
          <!-- Header -->
          <!-- filepath: c:\Users\khush\OneDrive\ecothon\THE-LOSERS-Ecothon-\templates\index.html -->
          <div class="flex justify-between items-center bg-green-700 p-4 rounded-2xl floating-card">

            <h1 class="text-2xl font-bold">ADMIN DASHBOARD</h1>
            <div class="flex items-center space-x-4">
              <div class="relative ">
                <button
                  class="bg-white rounded-full p-3 btn-animate flex items-center justify-center w-12 h-12 relative z-50"
                  onclick="toggleDropdown(event)">
                  <i class="fas fa-user text-gray-700"></i>
                </button>
                <div id="userDropdown"
                  class="absolute right-0 mt-2 w-48 bg-white rounded-lg shadow-xl py-2 hidden transform transition-all duration-100 ease-in-out z-[100]">
                  <p class="px-4 py-2 text-gray-700 truncate">{{ user.email }}</p>
                  <div class="border-t border-gray-200"></div>
                  <a href="/profile" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <i class="fas fa-id-badge mr-2"></i> Profile
                  </a>
                  <a href="/logout" class="block px-4 py-2 text-gray-700 hover:bg-gray-100">
                    <i class="fas fa-sign-out-alt mr-2"></i> Logout
                  </a>
                </div>
              </div>
            </div>
          </div>
          <!-- Content Grid -->
          <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mt-4">
            <!-- Sectorwise Consumption -->
            <div class="bg-green-700 p-4 rounded-lg floating-card">
              <h2 class="text-xl font-bold mb-4 text-center">Sectorwise Consumption</h2>
              <input id="sectorSearchInput" onkeyup="filterSectors()" class="w-full p-2 mb-4 rounded-lg text-black "
                placeholder="search" type="text" />
              <div id="sectorList" class="space-y-2">
                <button class="sector-item w-full bg-gray-700 text-gray-300 p-2 rounded-lg btn-animate"
                  onclick="navigateTo('adminPage')">
                  Admin
                </button>
                <button class="sector-item w-full bg-gray-700 text-gray-300 p-2 rounded-lg btn-animate"
                  onclick="navigateTo('csePage')">
                  CSE Department
                </button>
                <button class="sector-item w-full bg-gray-700 text-gray-300 p-2 rounded-lg btn-animate"
                  onclick="navigateTo('productionPage')">
                  Production Department
                </button>
                <button class="sector-item w-full bg-gray-700 text-gray-300 p-2 rounded-lg btn-animate"
                  onclick="navigateTo('mechanicalPage')">
                  Mechanical Department
                </button>
              </div>
            </div>
            <!-- Reports -->
            <div class="bg-green-700 p-4 rounded-lg col-span-1 md:col-span-2 floating-card">
              <h2 class="text-xl font-bold mb-4 text-center">Reports</h2>
              <div class="flex flex-col md:flex-row justify-around space-y-4 md:space-y-0">
                <div class="bg-gray-700 p-4 rounded-lg flex-1 mx-2 floating-card">
                  <h3 class="text-lg font-bold mb-2 text-center">Annual</h3>
                  <img alt="Annual report chart" class="rounded-lg img-hover mx-auto" height="100"
                    src="https://storage.googleapis.com/a1aa/image/HdbJ4jpDJNPg2ijnU_581dT-EWyqz4QS4ihqGJRSOsw.jpg"
                    width="100"
                    onclick="showGraphModal('Annual Report', 'https://storage.googleapis.com/a1aa/image/HdbJ4jpDJNPg2ijnU_581dT-EWyqz4QS4ihqGJRSOsw.jpg', 'The annual report shows the consumption patterns over the last year. Key observations include:<br><br>- 15% decrease in overall energy consumption<br>- Peak usage in summer months (May-August)<br>- Weekends show 40% less consumption than weekdays<br>- Estimated annual savings: $12,500')" />
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex-1 mx-2 floating-card">
                  <h3 class="text-lg font-bold mb-2 text-center">Monthly</h3>
                  <img alt="Monthly report chart" class="rounded-lg img-hover mx-auto" height="100"
                    src="https://storage.googleapis.com/a1aa/image/7_7HD1ErcLVSa__ru_K-HeGqNZMhfWem0GQinfip8tQ.jpg"
                    width="100"
                    onclick="showGraphModal('Monthly Report', 'https://storage.googleapis.com/a1aa/image/7_7HD1ErcLVSa__ru_K-HeGqNZMhfWem0GQinfip8tQ.jpg', 'The monthly report breaks down consumption patterns for the current month. Key highlights:<br><br>- Daily average consumption: 245 kWh<br>- Peak hours: 9-11 AM and 2-4 PM<br>- Weekend reduction: 37% compared to weekdays<br>- Most efficient day: Wednesday (12% below average)')" />
                </div>
                <div class="bg-gray-700 p-4 rounded-lg flex-1 mx-2 floating-card">
                  <h3 class="text-lg font-bold mb-2 text-center">Weekly</h3>
                  <img alt="Weekly report chart" class="rounded-lg img-hover mx-auto" height="100"
                    src="https://storage.googleapis.com/a1aa/image/SdZR7hu58FDkX50kXjnMUyLRP0B6X_6aBeAD7VgJSI4.jpg"
                    width="100"
                    onclick="showGraphModal('Weekly Report', 'https://storage.googleapis.com/a1aa/image/SdZR7hu58FDkX50kXjnMUyLRP0B6X_6aBeAD7VgJSI4.jpg', 'The weekly report shows day-by-day consumption patterns. Key findings:<br><br>- Highest consumption day: Monday (285 kWh)<br>- Lowest consumption day: Saturday (175 kWh)<br>- Average daily consumption: 240 kWh<br>- Automated systems saved approximately 320 kWh this week')" />
                </div>
              </div>
            </div>
            <!-- Power Saved -->
            <div class="bg-green-700 p-4 rounded-lg floating-card">
              <h2 class="text-xl font-bold mb-4 text-center">Power Saved</h2>
              <div class="flex flex-col items-center">
                <p class="text-4xl font-bold text-white mb-2">{{ saved }} kWh</p>
                <div class="w-full h-32">
                  <canvas id="powerSavedChart"></canvas>
                </div>
              </div>
            </div>
            <!-- Total Consumption -->
            <div class="bg-green-700 p-4 rounded-lg floating-card">
              <h2 class="text-xl font-bold mb-4 text-center">Total Consumption</h2>
              <div class="flex flex-col items-center">
                <p class="text-4xl font-bold text-white mb-2">{{ total }} kWh</p>
                <div class="w-full h-32">
                  <canvas id="totalConsumptionChart"></canvas>
                </div>
              </div>
            </div>
            <!-- Event Consumption -->
            <div class="bg-green-700 p-4 rounded-lg floating-card">
              <h2 class="text-xl font-bold mb-4 text-center">Event Consumption</h2>
              <div class="flex flex-col items-center">
                <div class="w-full h-40">
                  <canvas id="eventConsumptionChart"></canvas>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <script>
      function toggleDropdown() {
        const dropdown = document.getElementById('userDropdown');
        dropdown.classList.toggle('hidden');
      }

      function filterSectors() {
        const input = document.getElementById('sectorSearchInput');
        const filter = input.value.toLowerCase();
        const sectorList = document.getElementById('sectorList');
        const buttons = sectorList.getElementsByClassName('sector-item');

        for (let i = 0; i < buttons.length; i++) {
          const txtValue = buttons[i].textContent || buttons[i].innerText;
          if (txtValue.toLowerCase().indexOf(filter) > -1) {
            buttons[i].style.display = "";
          } else {
            buttons[i].style.display = "none";
          }
        }
      }

      function showGraphModal(title, imgSrc, info) {
        document.getElementById('graphTitle').innerText = title;
        document.getElementById('expandedGraph').src = imgSrc;
        document.getElementById('graphInfo').innerHTML = info;
        document.getElementById('graphModal').style.display = "block";
      }

      function closeModal() {
        document.getElementById('graphModal').style.display = "none";
      }

      function navigateTo(pageId) {
        window.location.href = '/department/' + pageId;
      }

      // Main Dashboard Charts
      const commonOptions = {
        responsive: true,
        maintainAspectRatio: false,
        plugins: { legend: { display: false } },
        scales: {
          x: { display: false },
          y: { display: false }
        }
      };

      // Power Saved Chart
      new Chart(document.getElementById('powerSavedChart'), {
        type: 'bar',
        data: {
          labels: ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun'],
          datasets: [{
            data: [12, 19, 3, 5, 2, 3],
            backgroundColor: '#4ade80'
          }]
        },
        options: commonOptions
      });

      // Total Consumption Trend
      new Chart(document.getElementById('totalConsumptionChart'), {
        type: 'line',
        data: {
          labels: {{ trend_labels | tojson }},
        datasets: [{
          data: {{ trend_values | tojson }},
        borderColor: '#ffffff',
        borderWidth: 2,
        tension: 0.4,
        fill: false
          }]
        },
        options: commonOptions
      });

      // Event Consumption Pie
      new Chart(document.getElementById('eventConsumptionChart'), {
        type: 'doughnut',
        data: {
          labels: ['Regular', 'Events'],
          datasets: [{
            data: [70, 30],
            backgroundColor: ['#15803d', '#facc15'],
            borderWidth: 0
          }]
        },
        options: {
          responsive: true,
          maintainAspectRatio: false,
          plugins: {
            legend: {
              display: true,
              position: 'bottom',
              labels: { color: '#ffffff', boxWidth: 10 }
            }
          }
        }
      });
    </script>
</body>

</html>